<p-toast></p-toast>
<div style="color: cornflowerblue;">
  <h2>
  Year {{ selectedYear$ | async }}
</h2>
</div>
<p-button styleClass="mb-2" label="Add PTO Entry" icon="pi pi-plus" class="mb-2"></p-button>

<ng-template #componentLoading class="d-flex justify-content-center mb-3">
  <div class="w-100 text-center mt-5">
    <span class="k-icon k-i-loading k-icon-xl"></span>
  </div>
</ng-template>

<div *ngIf="ptoSchedule$ | async as schedule">

  <p-table
    *ngIf="schedule; else componentLoading"
    [value]="schedule" 
    styleClass="p-datatable-gridlines p-datatable-striped p-datatable-sm" 
    [resizableColumns]="true"
    [tableStyle]="{ 'min-width': '30rem' }">
    <!-- <ng-template pTemplate="caption"> Header </ng-template> -->
    <ng-template pTemplate="header">
        <tr>
            <th style="width: 5rem;"></th> <!--edit button column-->
            <th pResizableColumn pSortableColumn="ptoDate">
              Date
              <p-sortIcon field="ptoDate"></p-sortIcon>
            <th pResizableColumn pSortableColumn="dayOfWeek">
              Day of Week
              <p-sortIcon field="dayOfWeek"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="reason">
              Reason
              <p-sortIcon field="reason"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="hours">
              Hours
              <p-sortIcon field="hours"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="isScheduled">
              Scheduled
              <p-sortIcon field="isScheduled"></p-sortIcon>
            </th>
            <th pResizableColumn pSortableColumn="isTaken">
              Taken
              <p-sortIcon field="isTaken"></p-sortIcon>
            </th>
            <!-- <th pSortableColumn="year">
              Year
              <p-sortIcon field="year"></p-sortIcon>
            </th> -->
            <th style="width: 5rem;"></th><!--delete button column-->
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-schedule>
        <tr>
          <td>
            <button type="button" pButton pRipple 
              icon="pi pi-pencil"                 
              class="p-button-sm p-button-raised"
              (click)="editPto(schedule)"   
              >
            </button>
        </td>
            <td>{{ schedule.ptoDate | date: 'MM/dd/yyyy' }}</td>
            <td>{{ schedule.dayOfWeek }}</td>
            <td>{{ schedule.reason }}</td>
            <td>{{ schedule.hours }}</td>
            <!-- <td [pEditableColumn]="schedule.hours" pEditableColumnField="hours">
              <p-cellEditor>
                  <ng-template pTemplate="input">
                      <input pInputText [(ngModel)]="schedule.hours" />
                  </ng-template>
                  <ng-template pTemplate="output">
                      {{ schedule.hours }}
                  </ng-template>
              </p-cellEditor>
          </td> -->
            <td>
              <i class="pi" [ngClass]="{ 'text-green-500 pi-check-circle': schedule.isScheduled, 'text-red-500 pi-times-circle': !schedule.isScheduled }"></i>
            </td>
            <td>
              <i class="pi" [ngClass]="{ 'text-green-500 pi-check-circle': schedule.isTaken, 'text-red-500 pi-times-circle': !schedule.isTaken }"></i>
            </td>
            <td>
              <button type="button" pButton pRipple 
                icon="pi pi-minus"                 
                class="p-button-sm p-button-danger p-button-raised"      
                (click)="deletePto(schedule)">
              </button>
              <!-- <p-button icon="pi pi-times" [rounded]="true" [text]="true" severity="danger" size="small"></p-button> -->
              <!-- <button type="button" pButton pRipple class="btn btn-danger btn-sm" icon="pi pi-minus"></button> -->
          </td>
        </tr>
    </ng-template>
    <!-- <ng-template pTemplate="summary"> Footer </ng-template> -->
  </p-table>

</div>

<ng-template id="exampleModal" let-modal>
  <!-- Actual modal body content -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <app-add-edit-modal></app-add-edit-modal>
  </div>
</ng-template>
